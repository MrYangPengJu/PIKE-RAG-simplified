## 5.1_1 I-O设备的概念和分类
1. 什么是I-O设备

输入/输出

2. 按使用特性分类

人机交互的外部设备

存储设备

网络通信设备

3. 按传输速率分类

低俗设备. 中速设备. 高速设备

4. 按信息交换的单位分类

块设备. 字符设备

## 5.1_2 I-O控制器
机械部件：鼠标等

电子部件

功能：

1. 接受和识别CPU发出的命令

控制寄存器

2. 向CPU报告设备的状态

状态寄存器

3. 数据交换

数据寄存器

4. 地址识别



内存映射IO

寄存器独立编制

## 5.1_3 I-O控制方式
1. 程序直接控制方式

轮询：完成一次读/写操作的流程

CPU干预频繁

每次读写一个字

实现简单

会使CPU忙等

2. 中断驱动方式

让cpu发出io指令后做其它的事情

大量中断会使cpu效率低

每次读写一个字

cpu和io可并行工作

3. DMA方式：直接存储器存取

数据单位：连续的多个块

直接从设备到内存

减少了cpu干预

DR：数据寄存器

MAR：内存地址寄存器

DC：剩余读写字节数

CR：命令/状态寄存器

4. 通道控制方式

弱鸡版cpu

通道程序：任务清单

cpu发送命令给通道，然后让通道处理IO操作就行了

处理完了，向cpu发送中断信号

## 5.1_4 I-O软件层次结构
1. 用户层软件

实现与用户交互的接口，向上提供方便易用的库函数

2. 设备独立性软件（设备无关性软件）

向上层提供统一的调用接口（read/write）

设备的保护

差错处理

设备的分配与回收

数据缓冲区管理

建立逻辑设备名到物理设备名的映射关系

根据设备类型选择调用相应的驱动程序

3. 设备驱动程序（比如打印机驱动）

设置设备寄存器. 检查设备状态

4. 中断处理程序

进行中断处理

5. 硬件

执行IO操作，有机械部件. 电子部件组成

## 5.1_5 I-O核心子系统
1. 用户层软件

假脱机系统

2. 设备独立性软件（设备无关性软件）

IO调度. 设备保护. 设备分配与回收. 缓冲区管理

3. 设备驱动程序（比如打印机驱动）

4. 中断处理程序

5. 硬件

## 5.1_6 假脱机技术
1. 什么是脱机技术，脱机技术可以解决什么问题

脱离主机的控制进行输入/输出控制

SPPOLing系统：必须要有多道程序并发进行

2. 假脱机技术的实现原理

输入井和输出井
输入进程和输出进程
输入缓冲区和输出缓冲区
3. 共享打印机的原理分析

## 5.1_7 设备的分配与回收
1. 设备分配时应考虑的因素

设备的固有属性：独占设备. 共享设备. 虚拟设备

设备分配算法：

设备分配中的安全：为进程分配一个设备后就将进程阻塞，本次IO完成后才将进程唤醒

2. 静态分配与动态分配

静态分配：进程运行前为其分配全部所需资源. 运行结束后归还资源

动态分配：运行中动态分配

3. 设备分配管理中的数据结构

树

系统设备表SDT，表目：（设备类型. 设备标识符. DCT. 驱动程序入口）

设备控制表DCT（设备类型. 设备标识符. 设备状态. 指向控制器表的指针. 重复执行次数或事件. 设备队列的队首指针）

控制器控制表COCT（控制器标识符. 控制器状态. 指向通道表的指针设备队列的队首指针. 控制器队列的队尾指针）

通道控制表CHCT（通道标识符. 通道状态. 与通道连接的控制器表首址. 通道队列的队首指针. 通道队列的队尾指针）

4. 设备分配的步骤

根据进程请求的物理设备名——>设备控制表——>控制器控制表——>通道

5. 设备分配步骤的改进方法

建立逻辑设备名和设备的映射

## 5.1_8 缓冲区管理
1. 什么时缓冲区？有什么作用？

缓冲区是一个存储区域

缓和CPU与IO设备之间速度不匹配的矛盾

减少对CPU的中断频率

解决数据粒度不匹配的问题

提高CPU与IO设备之间的并行性

2. 单缓冲

在内存中分配一块缓冲区

处理一块时间=max（C,T）+M

3. 双缓冲

在内存中分配两块缓冲区

max(T,C+M)

4. 循环缓冲

5. 缓冲池

由系统中共用的缓冲区组成。这些缓冲区可以分为：空缓冲队列. 装满输入数据的缓冲队列. 装满输出数据的缓冲队列
