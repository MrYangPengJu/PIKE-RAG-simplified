## 4.1_1 初识文件管理
提供的功能：

处理机管理

存储器管理

文件管理

设备管理

目标：安全高效

## 文化的属性
* 文件名
* 标识符
* 类型
* 位置
* 大小
* 创建时间、上次修改时间
* 文件所有者信息
* 保护信息

## 4.1_2 文件的逻辑结构
1. 无结构文件

文件由一系列二进制文件流组成

2. 有结构文件（记录式文件）

顺序文件：文件中的记录一个接一个顺序排列，定长或变长，可以顺序存储或者链式存储

按照是否与关键字顺序有关，可以分为串结构和顺序结构

链式：无法随机存取

顺序存储：

可变长：无法随机存取
定长：可以随机存取，采用串结构，无法快速找到关键字；采用顺序结构，可以快速查找关键字
索引文件：索引表本身是定长的顺序文件

索引顺序文件：多级索引表嵌套查找

## 4.1_3 文件目录
1. 文件控制块（FCB）

搜索. 创建文件. 删除文件. 显示目录. 修改目录

2. 目录结构

**单级目录结构（不允许文件重名）**
**两级目录结构**
* 主文件目录（MFD）+用户文件目录（UFD）
* 允许不同用户的文件重名

**多级目录结构（树形目录结构）**
* 不同目录下的文件可以重名
* 当代操作系统采用方法. 不便于文件共享

**无环图目录结构**
* 在树形目录结构的基础上，增加一些指向同一节点的有向边，使整个目录成为一个有向无环图。
* 可以用不同的文件名指向同一文件，每个共享节点设置一个共享计数器，若减为0，则删除结点。
* **注意**：共享文件不同于复制文件，在共享文件中，由于各用户指向的是同一个文件，incident只要其中一个用户修改了文件数据，那么所有用户都可以看到文件数据的变化。

3. 索引节点（对文件控制块）

压缩文件名和信息

## 4.1_4 文件的物理结构（文件分配方式）
1. 对非空闲磁盘块的管理

连续分配：连续分配方式要求每个文件在磁盘上占有一组连续的块，对文件的拓展不方便，有很多磁盘碎片

链接分配

隐式分配：采用链接分配方式的文件，只支持顺序访问，不支持随机访问，方便拓展
显示分配：文件分配表显式记录下一块物理块的位置，方便拓展，支持随机访问，文件表会占内存空间
## 4.1_4 文件的物理结构（文件分配方式）
索引分配

索引分配允许文件离散地分配在各个磁盘块中，系统会为每个文件建立一张索引表，索引表记录了文件的各个逻辑块对应的物理块

支持随机访问

链接方案
多层索引
混合索引
## 4.1_5 文件存储空间管理
1. 存储空间的划分与初始化

文件卷（逻辑卷）的概念
目录区与文件区
2. 几种管理方法

空闲表法：首位置+长度，回收时注意修改
空闲链表法（空闲盘块链. 空闲盘区链）
位示图法
成组链接法：文件卷的目录区中专门用一个磁盘块作为超级块，当系统启动时需要将超级内存块读入内存。并且保证内存与外存中的超级块数据一致。
## 4.1_6 文件的基本操作
创建文件（create）

1. 在外存中找到文件所需的空间

2. 创建该文件对应的目录项

删除文件(delete)

1. 找到文件名对应的目录项

2. 回收文件占用的磁盘块

3. 删除文件对应的目录项

读文件(read)

写文件(write)

打开文件(open)

1. 找到文件名对应的目录项

2. 将目录项复制到内存中的“打开文件”中

关闭文件(close)

## 4.1_7 文件共享
1. 基于索引结点的共享方式（硬链接）

直接指向文件的索引节点

2. 基于符号链的共享方式（软链接）

相当于win的快捷方式

## 4.1_8 文件保护
1. 口令保护

2. 加密保护

保密性强，不需要在系统中存储“密码”

编码/译码，需要花费一定时间

3. 访问控制

在每个文件的FCB中增加一个访问控制表（ACL），该表记录了各个用户可以对该文件执行哪些操作


## 4.2_1 磁盘的结构
磁盘. 磁道. 扇区的概念

如何在磁盘中读写数据

盘面柱面的概念

磁盘的物理地址

磁盘的分类

## 4.2_2 磁盘调度算法
	1. 一次磁盘读/写操作需要的时间

寻找时间Ts=s+m*n
延迟时间Tr=1/(2r)
传输时间Tt=b/(rN)
2. 磁盘调度算法

先来先服务（FCFS）
最短寻找时间优先（SSTF）
		优先处理最近的磁道，可能会产生饥饿现象

扫描算法（SCAN）	
		只有磁头移动到最外侧磁道的时候才能往内移动，移动到最内侧磁道的时候才能往外移动

	LOOK，如果在磁头移动方向上已经没有别的请求，就可以立即改变磁头移动方向

循环扫描算法（C-SCAN）
返回时直接快速移动至起始端而不处理任何请求

	C-LOOK，如果在磁头移动方向上已经没有别的请求，就可以立即改变磁头移动方向

## 4.2_3 减小磁盘延迟时间的方法
1. 寻找时间（寻道时间）：启动磁臂. 移动磁头所花的时间

2. 延迟时间：将目标扇区转到磁头下面所化的时间

磁头读取一块内容后，需要一小段的时间处理

采用交替编号策略

柱面号在盘面号之前，可以减少磁头移动消耗的时间

错位命名

3. 传输时间：读/写 数据花费的时间

## 4.2_4 磁盘的管理
1. 磁盘初始化

低级格式化/物理分区

2. 引导块

ROM不可修改，ROM中只存放很小的“自举装入程序”

3. 坏块的管理

在FAT表上标明（坏块对操作系统不透明）
